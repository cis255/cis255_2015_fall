â<?xml ver	sion="1.0" encoding="UTF-8"?> 
<!DOCTYPE html>

<html>
<head>

<meta charset="utf-8" />
<title>Module-D</title>
	
	<link rel="shortcut icon" href="img/us-flags/michigan.png">
	<script>
		/* 	for now place the stateData.json embedded 
			the data: States,				- when they entered the union, yyyy/mm/dd -> for sorting
				- captal cities, 
				- population as of 2015 (est), 
				- nick name, and 
				- image path for flag
		*/
		var stateData = [
			{"state_name":"Alabama","entered":"1819/12/14","capital":"Montgomery","population": "4779736", "nickname":"Yellowhammer State","flag":"alabama.png","color":"red"},
			{"state_name":"Alaska","entered":"1959/01/03","capital":"Juneau","population": "710231", "nickname":"The Last Frontier","flag":"alaska.png","color":"#000"},
			{"state_name":"Arizona","entered":"1912/02/14","capital":"Phoenix","population": "6392017", "nickname":"The Grand Canyon State","flag":"arizona.png","color":"#000080"},
			{"state_name":"Arkansas","entered":"1836/06/15","capital":"Little Rock","population": "2915918", "nickname":"The Natural State","flag":"arkansas.png","color":"#000"},
			{"state_name":"California","entered":"1850/09/09","capital":"Sacramento","population": "37253956", "nickname":"The Golden State","flag":"california.png","color":"#0000A0"},
			{"state_name":"Colorado","entered":"1876/08/01","capital":"Denver","population": "5029196", "nickname":"The Centennial State","flag":"colorado.png","color":"#000"},
			{"state_name":"Connecticut","entered":"1788/01/09","capital":"Hartford","population": "3574097", "nickname":"The Constitution State","flag":"connecticut.png","color":"#000"},
			{"state_name":"Delaware","entered":"1782/12/07","capital":"Dover","population": "897934", "nickname":"The First State","flag":"delaware.png","color":"#0040B0"},
			{"state_name":"Florida","entered":"1845/03/03","capital":"Tallahassee","population": "18801310", "nickname":"The Sunshine State","flag":"florida.png","color":"#FF8000"},
			{"state_name":"Georgia","entered":"1788/01/02","capital":"Atlanta","population": "9687653", "nickname":"The Peach State","flag":"georgia.png","color":"#000"},
			{"state_name":"Hawaii","entered":"1959/08/21","capital":"Honolulu","population": "1360301", "nickname":"The Aloha State","flag":"hawaii.png","color":"#000"},
			{"state_name":"Idaho","entered":"1890/07/03","capital":"Boise","population": "1567582", "nickname":"The Gem State","flag":"idaho.png","color":"#F00"},
			{"state_name":"Illinois","entered":"1818/12/03","capital":"Springfield","population": "12830632", "nickname":"Prairie State","flag":"illinois.png","color":"#000"},
			{"state_name":"Indiana","entered":"1816/12/11","capital":"Indianapolis","population": "6483802", "nickname":"The Hoosier State","flag":"indiana.png","color":"#00F"},
			{"state_name":"Iowa","entered":"1846/12/28","capital":"Des Moines","population": "3046355", "nickname":"The Hawkeye State","flag":"iowa.png","color":"#000"},
			{"state_name":"Kansas","entered":"1861/01/29","capital":"Topeka","population": "2853118", "nickname":"The Sunflower State","flag":"kansas.png","color":"#000"},
			{"state_name":"Kentucky","entered":"1792/06/01","capital":"Frankfort","population": "4339367", "nickname":"The Bluegrass State","flag":"kentucky.png","color":"#0050B0"},
			{"state_name":"Louisiana","entered":"1812/04/30","capital":"Baton Rouge","population": "4533372", "nickname":"The Pelican State","flag":"louisiana.png","color":"#00F"},
			{"state_name":"Maine","entered":"1812/03/15","capital":"Augusta","population": "1328361", "nickname":"The Pine Tree State","flag":"maine.png","color":"#000"},
			{"state_name":"Maryland","entered":"1788/04/28","capital":"Annaplois","population": "5773552", "nickname":"The Old Line State","flag":"maryland.png","color":"#F00"},
			{"state_name":"Massachusetts","entered":"1788/02/06","capital":"Boston","population": "6547629", "nickname":"The Bay State","flag":"massachusetts.png","color":"#00F"},
			{"state_name":"Michigan","entered":"1837/01/26","capital":"Lansing","population": "9883640", "nickname":"The Great Lake State","flag":"michigan.png","color":"#00A0FF"},
			{"state_name":"Minnesota","entered":"1858/05/11","capital":"St. Paul","population": "5303925", "nickname":"The North Star State","flag":"minnesota.png","color":"#000"},
			{"state_name":"Mississippi","entered":"1817/12/10","capital":"Jackson","population": "2967297", "nickname":"The Magnolia State","flag":"mississippi.png","color":"#000"},
			{"state_name":"Missouri","entered":"1821/08/10","capital":"Jefferson City","population": "5988927", "nickname":"The Show Me State","flag":"missouri.png","color":"#000"},
			{"state_name":"Montana","entered":"1889/11/08","capital":"Helena","population": "989415", "nickname":"The Treasure State","flag":"montana.png","color":"#1080A0"},
			{"state_name":"Nebraska","entered":"1867/03/01","capital":"Lincoln","population": "1826341", "nickname":"The Cornhusker State","flag":"nebraska.png","color":"#000"},
			{"state_name":"Nevada","entered":"1864/10/31","capital":"Carson City","population": "2700551", "nickname":"The Silver State","flag":"nevada.png","color":"#A0A0B8"},
			{"state_name":"New Hampshire","entered":"1788/06/21","population": "1316470","nickname":"The Granite State","flag":"new_hampshire.png","color":"#000"},
			{"state_name":"New Jersey","entered":"1787/12/18","capital":"Trenton","population": "8791894", "nickname":"The Garden State","flag":"new_jersey.png","color":"#A0A000"},
			{"state_name":"New Mexico","entered":"1912/01/06","capital":"Santa Fe","population": "2059179", "nickname":"The Land of Enchantment","flag":"new_mexico.png","color":"#00F"},
			{"state_name":"New York","entered":"1788/07/26","capital":"Albany","population": "19378102", "nickname":"The Empire State","flag":"new_york.png","color":"#000090"},
			{"state_name":"North Carolina","entered":"1798/11/21","capital":"Raleigh","population": "9535483", "nickname":"The Tar Heel State","flag":"north_carolina.png","color":"#F00"},
			{"state_name":"North Dakota","entered":"1889/11/02","capital":"Bismark","population": "672591", "nickname":"The Peace Garden State","flag":"north_dakota.png","color":"#000"},
			{"state_name":"Ohio","entered":"1803/03/01","capital":"Columbus","population": "11536504", "nickname":"The Buckeye State","flag":"ohio.png","color":"#F00"},
			{"state_name":"Oklahoma","entered":"1907/11/06","capital":"Oklahoma City","population": "3751351", "nickname":"The Sooner State","flag":"oklahoma.png","color":"#0F0"},
			{"state_name":"Oregon","entered":"1859/02/14","capital":"Salem","population": "3831074", "nickname":"The Beaver State","flag":"oregon.png","color":"#00090"},
			{"state_name":"Pennsylvania","entered":"1787/12/12","capital":"Harrisberg","population": "12702379", "nickname":"The Keystone State","flag":"pennsylvania.png","color":"#600090"},
			{"state_name":"Rhode Island","entered":"1790/05/29","capital":"Province","population": "1052567", "nickname":"The Ocean State","flag":"rhode_island.png","color":"#000"},
			{"state_name":"South Carolina","entered":"1788/05/23","capital":"Columbia","population": "4625364", "nickname":"The Palmetto State","flag":"south_carolina.png","color":"#001080"},
			{"state_name":"South Dakota","entered":"1889/11/02","capital":"Pierre","population": "814180", "nickname":"Mount Rushmore State","flag":"south_dakota.png","color":"#000"},
			{"state_name":"Tennessee","entered":"1796/06/01","capital":"Nashville","population": "6346105", "nickname":"The Volunteer State","flag":"tennessee.png","color":"orange"},
			{"state_name":"Texas","entered":"1845/12/29","capital":"Austin", "population":"25145561", "nickname":"The Lone Star State","flag":"texas.png","color":"#F00"},
			{"state_name":"Utah","entered":"1891/03/01","capital":"Salt Lake City","population": "	2763885", "nickname":"The Behive State","flag":"utah.png","color":"#000"},
			{"state_name":"Vermont","entered":"1791/03/01","capital":"Montpelier","population": "625741", "nickname":"The Green Mountain State","flag":"vermont.png","color":"#30C890"},
			{"state_name":"Virginia","entered":"1788/06/25","capital":"Richmond","population": "8001024", "nickname":"The Old Dominion State","flag":"virgina.png","color":"#40C060"},
			{"state_name":"Washington","entered":"1889/11/11","capital":"Olimpia","population": "6724540", "nickname":"The Evergreen State","flag":"washington.png","color":"#000"},
			{"state_name":"West Virginia","entered":"1863/06/20","capital":"Charleston","population": "1852994", "nickname":"The Mountain State","flag":"west_virginia.png","color":"#00A0B0"},
			{"state_name":"Wisconsin","entered":"1848/05/29","capital":"Madison","population": "5686986", "nickname":"The Badger State","flag":"wisconsin.png","color":"#A04000"},
			{"state_name":"Wyoming","entered":"1890/07/10","capital":"Cheyenne","population": "563626","nickname":"The Cowboy State","flag":"wyoming.png","color":"#005050"}
		];
	
	</script>	
	
	<script type="text/javascript">
		
		/* saves the item selected */	
		var selectedState = 0;
		var colorDefault = 1;
		/* when a state is selected, set the input boxes and expand/close the details of the state */
		
		function stateActivate(item) {
			
			/* pretty safe, this function will not be called unless an item is selected */
			var prevSelected = selectedState;
			selectedState = document.getElementById("state_" + stateData[item].state_name);
						
			if (prevSelected) {
				prevSelected.style.backgroundColor = "#C0C0F0";
			}
			document.getElementById("in_state_name").value = stateData[item].state_name;
			document.getElementById("in_cap_city").value = stateData[item].capital;
				
			var childNode = selectedState.lastChild;
			
			console.log(childNode.style.display);
			
			if (childNode.style.display != "inherit") {					// is the display style inherited
				selectedState.style.backgroundColor = "#707090";
				childNode.style.display = "inherit";
				document.getElementById("btnDelete").disabled = false;
			} else {
				if (prevSelected == selectedState) {
					selectedState.style.backgroundColor = "#C0C0F0";
					childNode.style.display = "";						// nope, then hide it
					document.getElementById("btnDelete").disabled = true;
				} else 
					selectedState.style.backgroundColor = "#707090";
							
			}
		}
		
		/* this app only allows changes to state capital name */
		function updateState() {
			
			if (selectedState) {
			
				var divChildNode = selectedState.lastChild;			
				var divChildren = divChildNode.childNodes;
				/*  
					this loop is not nessiarily important, i was thinking about being able to delete any
					i was considering implementing an ability to change any values, not just cap-city
					- maybe some other time
				*/
				for(var i = 0; i < (divChildren.length); i++) {
					if (divChildren[i].id == "ID-CAPITAL") {
						divChildren[i].innerHTML = "Capital:              " + document.getElementById("in_cap_city").value;
						break;
					}
				}
				
			} else {
				alert("please select a state before continuing!");			
			}
		}
		
		/* deletes a state from the DOM */
		
		function deleteState() {
			if (selectedState) {
				var rememberText = selectedState.id;
				selectedState.parentNode.removeChild(selectedState);
				selectedState = 0;
				alert("Deleted: [ " + rememberText + " ]");
			} else {
				alert("please select a state before continuing!");			
			}
			document.getElementById("btnDelete").disabled = true;
		}
		
		/* 
			dates of entry into the union were entered as mm/dd/yyyy
			this function converts that format into:
			
			!it was not set as a JSON time stamp
			
			(month name) dd, yyyy
		
		*/
		
		function longDate(ds) {
			if (typeof ds === 'string') {
				
				var parts = ds.split("/");
				var result;
				
				switch(parts[1]) {
					case '01': result = "January "; break;
					case '02': result = "February "; break;
					case '03': result = "March "; break;
					case '04': result = "April "; break;
					case '05': result = "May "; break;
					case '06': result = "June "; break;
					case '07': result = "July "; break;
					case '08': result = "August "; break;
					case '09': result = "September "; break;
					case '10': result = "October "; break;
					case '11': result = "November "; break;
					case '12': result = "December "; break;
				}
				
				result = result + (parts[1]);
				result = result + ", ";
				result = result + (parts[0]);
				
				return result;
			}
			else 
				return "[invalid]";
		}	
		
		/* adds commas between groupings of a long number number */
		function groupNumber(numStr) {
			
			if (typeof numStr === 'string') {
				var cmPos = (numStr.length % 3);	// find offset of first comma
				var result = "";					
				
				if (cmPos == 0) cmPos = 3;			// if results are 0, wait
				
				for(var i = 0; i < numStr.length; i++) {
					if (cmPos-- == 0) {
						cmPos = 2;
						result = result + ",";		// insert the comma
					}
					result = result + numStr[i];	// insert the number
				}
				
				return result;
			
			}
			
			return numStr;	
		}
		
		function changeColor() {
			var nodes = document.getElementsByClassName("iStateLi");
			if (colorDefault == 1)
				colorDefault = 0;
			else
				colorDefault = 1;
						
			for(var i = 0; i < nodes.length;i++) {
				if (colorDefault)
					nodes[i].style.color = "black";
				else
					nodes[i].style.color = stateData[i].color;
			}
			
		}
		
		/* deletes children of <div> stateList, and reloads data from JSON */
		function resetForm() {
			var parentNode = document.getElementById("stateList");
			while (parentNode.firstChild) {
				parentNode.removeChild(parentNode.firstChild);
			}
			initForm();

		}
		
		var sortBy = [ "state_name", "capital", "entered" ];

		function sortStatesData(fieldX) {
		    stateData = stateData.sort(function(val1, val2) {
			return (val1[fieldX] > val2[fieldX]) ? 1 : ((val1[fieldX] < val2[fieldX]) ? -1 : 0);
			
		    });
		    
		}

		function sortItBy(i) {
			sortStatesData(sortBy[i]);
			resetForm();
			
		}
		
		function initForm() {
			var dest = document.getElementById("stateList");
			document.getElementById("btnDelete").disabled = true;
			
			for(var i=0; i<stateData.length;i++) {
				var uNode = document.createElement("li");
				var uDiv = document.createElement("div");
				var liNodes = document.createElement("li");
				uNode.className = "iStateLi";
				uNode.id = "state_" + stateData[i].state_name;
				uNode.setAttribute("onclick", "return stateActivate(" + i + ");");
				uDiv.className = "iStateData";
				uNode.innerHTML = stateData[i].state_name;
				uNode.appendChild(uDiv);
				dest.appendChild(uNode);
				
				var liNodes = document.createElement("li");
				
				liNodes.innerHTML = "Capital:              " + stateData[i].capital;
				liNodes.id = "ID-CAPITAL";
				uDiv.appendChild(liNodes);
				
				liNodes = document.createElement("li");
				liNodes.id = "ID-NICKNAME";
				liNodes.innerHTML = "Nickname:             " + stateData[i].nickname;
				uDiv.appendChild(liNodes);
				
				liNodes = document.createElement("li");
				liNodes.id = "ID-POPULATION";
				liNodes.innerHTML = "Population(2015est):  " + groupNumber(stateData[i].population);
				uDiv.appendChild(liNodes);
				
				
				liNodes = document.createElement("li");
				liNodes.id = "ID-DATE";
				liNodes.innerHTML = "Entered Union:        " + longDate(stateData[i].entered);
				
				uDiv.appendChild(liNodes);
				
				liNodes = document.createElement("li");
				liNodes.id = "ID-FLAG";
				liNodes.innerHTML = "State Flag:           ";
				
				var liImage = document.createElement("img");
				liImage.setAttribute("src", "us-flags/" + stateData[i].flag);
				liNodes.appendChild(liImage);
				uDiv.appendChild(liNodes);
					
			}
			document.getElementById("in_state_name").value = "";
			document.getElementById("in_cap_city").value = "";
		}
	
	</script>
	<!-- this is a small file, CSS is embedded -->
	
	<style type="text/css">
		
		.dialog_frame {
 			margin: 12px auto;
			border: solid 1px;
			border-color: #7070B0;		
			box-shadow: 7px 7px 3px #8080A0;
			padding: 6px 8px 8px 8px;
			max-width: 520px;
		}
		
		.dialog_title_bar {
			
			font-size: 				20px;
			font-weight: 			600;
			background-color: 		#4090F0;
			padding: 				8px;		
			text-shadow: 			2px 2px 5px grey;
			color: 					white;
			margin-bottom: 			8px;
			border-style: 			solid;
			border-width: 			1px;
			border-color: 			#AAAAFF;
		}
		
		input {
			width:100%;		
			margin-bottom: 3px;					
		}
		
		.divStates {
			padding: 1px;
			width: 100%;
			min-height: 			200px;
			max-height:				360px;
			color: 					black;
			margin-bottom: 			8px;
			border-style: 			solid;
			border-width: 			1px;
			border-color: 			#8A8ABB;
			overflow-y: 			scroll;
		}	
		
		.divStates li {
			border-color: #8A8ABB;
			border-style: solid;
			border-width: 1px;
			list-style-type: none;
			background-color: #C0C0F0;
			margin: 1px;
			padding: 3px;
			
		}

		.divStates li:active {
			color:blue;
		}

		.divStates li:hover {
			cursor:pointer;
		}

		button {
			margin-bottom: 		2px;
			margin-top:    		2px;
		}
		
		.iStateData {
			height: auto;
			width: 100%;
			border-width: 1px;
			border-style: solid;
			border-color: black;
			color: black;
			background-color: #afafc0;	
			display:none;
			white-space: pre;
			font-family: monospace;
		}
		
		.iStateData li {
			background-color: #bfbfd0;
		}
		
	</style>	
	
</head>
<body>

	<div class="dialog_frame">
	 	<div class="dialog_title_bar" >Basic HTML (Ch.2) and HTML Generators - State Data</div>
    	<div style = "margin-right:10px;">
				<input id = "in_state_name" type="text" placeholder="state name" disabled>
				<input id = "in_cap_city" type="text" placeholder="capitol city">
				 
				 <hr>

        		<button onclick="updateState();">Update</button>
        		<button id ="btnDelete" onclick="deleteState();">Delete State</button>
        		<button onclick="changeColor();">Use State Colors</button>
        		<br>
        		<button onclick="sortItBy(0);">sort: name</button>
        		<button onclick="sortItBy(1);">sort: capital</button>
        		<button onclick="sortItBy(2);">sort: entry into union</button>
        		
        		<button style="margin-left:20px;" onclick="resetForm();">Reset form</button>
				<hr>
        		
				<p style="font-size:12px;margin:1px;color:blue;">Note: state colors may not match correctly if state was deleted.</p>
			<br>				
			<div id="stateList" class="divStates">
						<!-- DOM changes will occure in this area -->
			
			</div>				
			
			<button><a href="http://csis.svsu.edu/~gpcorser/cis255/cis255.html" style="text-decoration:none;">Return To Class Page</a></button>		
			
	</div>
	</div>
	<script type="text/javascript">
		 initForm();
	</script>
</body>
</html>
